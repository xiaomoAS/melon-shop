{"version":3,"file":"ifica.js","sources":["pages/ifica/ifica.vue","pages/ifica/ifica.vue?type=page"],"sourcesContent":["<template>\r\n\t\r\n\t\t<view>\r\n\t\t\t<view class=\"ifica_search_head\">\r\n\t\t\t\t<view class=\"int_cont\">\r\n\t\t\t\t\t<image class=\"i\" src=\"https://melonbamboo.oss-cn-beijing.aliyuncs.com/melonbamboo/4504ca659b80453ca747baaabba8d106/ico_1.png?Expires=2073875740&OSSAccessKeyId=LTAI5tHrbcXwiX27kw8s1cSb&Signature=yYeoocs0saGNdYETNQ9FgrHVaB0%3D\" mode=\"widthFix\"></image>\r\n\t\t\t\t\t<input type=\"text\" placeholder=\"搜索您的商品\">\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"ifiac_filter_cont\">\r\n\t\t\t\t<view class=\"l_filter_nav\">\r\n\t\t\t\t\t<view class=\"li\" :class=\"{ active: item.id === activeCate }\" v-for=\"item in cateList\" :key=\"item.id\" @click=\"cateClickHandler(item.id)\">{{ item.name }}</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"main_cont\">\r\n\t\t\t\t\t<view class=\"index_pro_contain\">\r\n\t\t\t\t\t\t<image class=\"pro_head_bg\" src=\"https://melonbamboo.oss-cn-beijing.aliyuncs.com/melonbamboo/608def905ee846eab80b698d5d29c6e5/index_case2_bg.png?Expires=2073875992&OSSAccessKeyId=LTAI5tHrbcXwiX27kw8s1cSb&Signature=Zd2Oz8m0uYQy8idN34qA4pxtSJc%3D\" mode=\"widthFix\"></image>\r\n\t\t\t\t\t\t<view class=\"title_head\">\r\n\t\t\t\t\t\t\t<image class=\"logo\" src=\"https://melonbamboo.oss-cn-beijing.aliyuncs.com/melonbamboo/b5a62a0a9f344046b6ecccd5d5f9184a/pro_logo.png?Expires=2073875894&OSSAccessKeyId=LTAI5tHrbcXwiX27kw8s1cSb&Signature=UhwsRTz1JJlnDOlP0K4Tm0ABWGk%3D\" mode=\"widthFix\"></image>\r\n\t\t\t\t\t\t\t<view class=\"dt\">团购好货</view>\r\n\t\t\t\t\t\t\t<view class=\"txt\">三餐四季 尽在知花</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"pro_list_cont\" v-for=\"(item, index) in productList\" :key=\"index\" :class=\"{ 'null': !item.stock }\">\r\n\t\t\t\t\t\t\t<ProductItem :info=\"item\" />\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<LoadMore \r\n\t\t\t\t\t\tv-if=\"!noMoreData\"\r\n\t\t\t\t\t\t@visible=\"loadMoreData\" \r\n\t\t\t\t\t\t:threshold=\"50\"\r\n\t\t\t\t\t\t:once=\"false\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<view class=\"custom-load-more\">\r\n\t\t\t\t\t\t\t<span>上拉加载更多</span>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</LoadMore>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n</template>\r\n\r\n<script>\r\nimport ProductItem from '@/components/product-item/ProductItem.vue'\r\nimport LoadMore from '@/components/load-more/index.vue'\r\n\r\nexport default{\r\n\tdata(){\r\n\t\treturn {\r\n\t\t\tcateList:[],\r\n\t\t\tproductList: [],\r\n\t\t\tpage: 1,\r\n\t\t\tpageSize: 5,\r\n\t\t\ttotalCount: 0,\r\n\t\t\tactiveCate: null,\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tnoMoreData() {\r\n\t\t\treturn this.page * this.pageSize >= this.totalCount\r\n\t\t},\r\n\t},\r\n\tcomponents: {\r\n\t\tProductItem,\r\n\t\tLoadMore\r\n\t},\r\n\tasync onShow() {\r\n\t\tthis.productList = []\r\n\t\tthis.page = 1 // 重置页码\r\n\t\tconst id = wx.getStorageSync('cateId')\r\n\t\tawait this.getCates()\r\n\t\tthis.activeCate = id || (this.cateList.length ? this.cateList[0].id : null)\r\n\t\tthis.getProductList()\r\n\t},\r\n\tmethods: {\r\n\t\tcateClickHandler(id) {\r\n\t\t\tthis.productList = []\r\n\t\t\tthis.page = 1 // 重置页码\r\n\t\t\tthis.activeCate = id;\r\n\t\t\tthis.getProductList()\r\n\t\t},\r\n\t\tasync getCates() {\r\n\t\t\ttry {\r\n\t\t\t\tthis.cateList = await this.$http.post('/index/cats', {})\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.cateList = []\r\n\t\t\t}\r\n\t\t},\r\n\t\tloadMoreData() {\r\n\t\t\t// 检查是否还有更多数据\r\n\t\t\tif (this.noMoreData) {\r\n\t\t\t\tconsole.log('没有更多数据了')\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t// 增加页码并加载下一页\r\n\t\t\tthis.page = this.page + 1\r\n\t\t\tthis.getProductList()\r\n\t\t},\r\n\t\tasync getProductList() {\r\n\t\t\ttry {\r\n\t\t\t\tconst { rows, total } = await this.$http.post('/items/catItems', {\r\n\t\t\t\t\tcateId:this.activeCate ? Number(this.activeCate) : null,\r\n\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\t})\r\n\t\t\t\tthis.productList.push(...rows)\r\n\t\t\t\tthis.totalCount = total\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.productList = []\r\n\t\t\t\tthis.totalCount = 0\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n\t@import url(/pages/ifica/ifica.css);\r\n\t@import url(/pages/index/prolast.css);\r\n</style>","import MiniProgramPage from '/Users/jiangzupei1/Desktop/melon-shop/pages/ifica/ifica.vue'\nwx.createPage(MiniProgramPage)"],"names":["wx","uni"],"mappings":";;AA0CA,MAAO,cAAa,MAAW;AAC/B,iBAAiB,MAAW;AAE5B,MAAK,YAAS;AAAA,EACb,OAAM;AACL,WAAO;AAAA,MACN,UAAS,CAAE;AAAA,MACX,aAAa,CAAE;AAAA,MACf,MAAM;AAAA,MACN,UAAU;AAAA,MACV,YAAY;AAAA,MACZ,YAAY;AAAA,IACb;AAAA,EACA;AAAA,EACD,UAAU;AAAA,IACT,aAAa;AACZ,aAAO,KAAK,OAAO,KAAK,YAAY,KAAK;AAAA,IACzC;AAAA,EACD;AAAA,EACD,YAAY;AAAA,IACX;AAAA,IACA;AAAA,EACA;AAAA,EACD,MAAM,SAAS;AACd,SAAK,cAAc,CAAC;AACpB,SAAK,OAAO;AACZ,UAAM,KAAKA,cAAAA,KAAG,eAAe,QAAQ;AACrC,UAAM,KAAK,SAAS;AACpB,SAAK,aAAa,OAAO,KAAK,SAAS,SAAS,KAAK,SAAS,CAAC,EAAE,KAAK;AACtE,SAAK,eAAe;AAAA,EACpB;AAAA,EACD,SAAS;AAAA,IACR,iBAAiB,IAAI;AACpB,WAAK,cAAc,CAAC;AACpB,WAAK,OAAO;AACZ,WAAK,aAAa;AAClB,WAAK,eAAe;AAAA,IACpB;AAAA,IACD,MAAM,WAAW;AAChB,UAAI;AACH,aAAK,WAAW,MAAM,KAAK,MAAM,KAAK,eAAe,EAAE;AAAA,MACtD,SAAO,OAAO;AACf,aAAK,WAAW,CAAC;AAAA,MAClB;AAAA,IACA;AAAA,IACD,eAAe;AAEd,UAAI,KAAK,YAAY;AACpBC,sBAAAA,MAAA,MAAA,OAAA,+BAAY,SAAS;AACrB;AAAA,MACD;AAEA,WAAK,OAAO,KAAK,OAAO;AACxB,WAAK,eAAe;AAAA,IACpB;AAAA,IACD,MAAM,iBAAiB;AACtB,UAAI;AACH,cAAM,EAAE,MAAM,MAAQ,IAAE,MAAM,KAAK,MAAM,KAAK,mBAAmB;AAAA,UAChE,QAAO,KAAK,aAAa,OAAO,KAAK,UAAU,IAAI;AAAA,UACnD,MAAM,KAAK;AAAA,UACX,UAAU,KAAK;AAAA,SACf;AACD,aAAK,YAAY,KAAK,GAAG,IAAI;AAC7B,aAAK,aAAa;AAAA,MACjB,SAAO,OAAO;AACf,aAAK,cAAc,CAAC;AACpB,aAAK,aAAa;AAAA,MACnB;AAAA,IACA;AAAA,EACD;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/GA,GAAG,WAAW,eAAe;"}