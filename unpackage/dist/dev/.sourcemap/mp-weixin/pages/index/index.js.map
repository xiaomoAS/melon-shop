{"version":3,"file":"index.js","sources":["pages/index/index.vue","pages/index/index.vue?type=page"],"sourcesContent":["<template>\r\n\t<view>\r\n\t\t<view class=\"head_logo\">LOGO</view>\r\n\t\t<image src=\"https://melonbamboo.oss-cn-beijing.aliyuncs.com/melonbamboo/916cae2f99af4241acf65617a6a07bd9/index_head_bg.png?Expires=2073875593&OSSAccessKeyId=LTAI5tHrbcXwiX27kw8s1cSb&Signature=6l%2B1kM%2BmbcTT4vmhVbD6zlktjVo%3D\" class=\"index_head_bg\" mode=\"widthFix\"></image>\r\n\t\t<view class=\"contain\">\r\n\t\t\t<view class=\"index_header_cont\">\r\n\t\t\t\t<view class=\"index_search\">\r\n\t\t\t\t\t<image class=\"i\" src=\"https://melonbamboo.oss-cn-beijing.aliyuncs.com/melonbamboo/4504ca659b80453ca747baaabba8d106/ico_1.png?Expires=2073875740&OSSAccessKeyId=LTAI5tHrbcXwiX27kw8s1cSb&Signature=yYeoocs0saGNdYETNQ9FgrHVaB0%3D\" mode=\"widthFix\" @click=\"toSearchPage\"></image>\r\n\t\t\t\t\t<input v-model=\"searchWords\" type=\"text\" placeholder=\"搜索您喜欢的商品\">\r\n\t\t\t\t\t<view class=\"btn\" @click=\"toSearchPage\">搜索</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<swiper class=\"index_baner\" :autoplay=\"true\" :interval=\"3000\" :duration=\"1000\">\r\n\t\t\t\t\t<swiper-item v-for=\"(item,index) in carouselImages\" :key=\"index\">\r\n\t\t\t\t\t\t<view class=\"swiper-item\"><image :src=\"item.url\" name=\"{{item.name}}\" id=\"{{item.id}}\" mode=\"aspectFill\"></image> </view>\r\n\t\t\t\t\t</swiper-item>\r\n\t\t\t\t</swiper>\r\n\t\t\t\t<view class=\"index_navi_cont\">\r\n\t\t\t\t\t<view class=\"list\" @click=\"toCatePage()\">\r\n\t\t\t\t\t\t<view class=\"tis_i\"><image src=\"https://melonbamboo.oss-cn-beijing.aliyuncs.com/melonbamboo/3db470eba37b45109b31a31bc4862b42/quanbushangpin.png?Expires=2073903146&OSSAccessKeyId=LTAI5tHrbcXwiX27kw8s1cSb&Signature=DTAVQSjY5F6da5ibaWHkzyipNus%3D\" mode=\"widthFix\"></image> </view>\r\n\t\t\t\t\t\t<view class=\"txt\">全部商品</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view v-for=\"item in cateList.slice(0, 4)\" :key=\"item.id\" class=\"list\" @click=\"toCatePage(item.id)\">\r\n\t\t\t\t\t\t<view class=\"tis_i\"><image :src=\"item.logoUrl\" mode=\"widthFix\"></image> </view>\r\n\t\t\t\t\t\t<view class=\"txt\">{{ item.name }}</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"index_new_vip\">\r\n\t\t\t\t\t<image class=\"tips\" src=\"https://melonbamboo.oss-cn-beijing.aliyuncs.com/melonbamboo/29b37b79ca524070b69881a8a0be4d84/tip_1.png?Expires=2073875832&OSSAccessKeyId=LTAI5tHrbcXwiX27kw8s1cSb&Signature=yea3i%2FfwVPnD91oEwgNeiUyJ4x8%3D\" mode=\"widthFix\"></image>\r\n\t\t\t\t\t<view class=\"head_title\">\r\n\t\t\t\t\t\t<view class=\"tle\">新人<text>专享</text> </view>\r\n\t\t\t\t\t\t<view class=\"txt\">开启品质生活</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view v-if=\"newPersonList.length\" class=\"pro_last\">\r\n\t\t\t\t\t\t<view v-for=\"(newItem, index) in newPersonList\" :key=\"index\" class=\"list_cont\">\r\n\t\t\t\t\t\t\t<view class=\"tis_i\">\r\n\t\t\t\t\t\t\t\t<image class=\"i\" :src=\"newItem.imgUrl\" mode=\"widthFix\"></image> \r\n\t\t\t\t\t\t\t\t<view class=\"tip_txt\">新客专享</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"pro_name\">{{ newItem.title }}</view>\r\n\t\t\t\t\t\t\t<view class=\"pro_price\">\r\n\t\t\t\t\t\t\t\t<view class=\"dt\">新人价</view>\r\n\t\t\t\t\t\t\t\t<view class=\"dd\">￥{{ newItem.realpayPrice }}</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"index_pro_contain\">\r\n\t\t\t<image class=\"pro_head_bg\" src=\"https://melonbamboo.oss-cn-beijing.aliyuncs.com/melonbamboo/608def905ee846eab80b698d5d29c6e5/index_case2_bg.png?Expires=2073875992&OSSAccessKeyId=LTAI5tHrbcXwiX27kw8s1cSb&Signature=Zd2Oz8m0uYQy8idN34qA4pxtSJc%3D\" mode=\"widthFix\"></image>\r\n\t\t\t<view class=\"title_head\">\r\n\t\t\t\t<image class=\"logo\" src=\"https://melonbamboo.oss-cn-beijing.aliyuncs.com/melonbamboo/b5a62a0a9f344046b6ecccd5d5f9184a/pro_logo.png?Expires=2073875894&OSSAccessKeyId=LTAI5tHrbcXwiX27kw8s1cSb&Signature=UhwsRTz1JJlnDOlP0K4Tm0ABWGk%3D\" mode=\"widthFix\"></image>\r\n\t\t\t\t<view class=\"dt\">团购好货</view>\r\n\t\t\t\t<view class=\"txt\">三餐四季 尽在知花</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"pro_list_cont\" v-for=\"item in productList\" :key=\"item.productId\" :class=\"{ 'null': !item.stock }\">\r\n\t\t\t\t<ProductItem :info=\"item\" />\r\n\t\t\t</view>\r\n\t\t\t<LoadMore \r\n\t\t\t\tv-if=\"!noMoreData\"\r\n\t\t\t\t@visible=\"loadMoreData\" \r\n\t\t\t\t:threshold=\"50\"\r\n\t\t\t\t:once=\"false\"\r\n\t\t\t>\r\n\t\t\t\t<view class=\"custom-load-more\">\r\n\t\t\t\t\t<span>上拉加载更多</span>\r\n\t\t\t\t</view>\r\n\t\t\t</LoadMore>\r\n\t\t</view>\r\n\t\t<ShopCart ref=\"shopCartRef\" />\r\n\t</view>\r\n</template>\r\n<script>\r\n\timport ProductItem from '@/components/product-item/ProductItem.vue'\r\n\timport ShopCart from '@/components/shop-cart/ShopCart.vue'\r\n\timport LoadMore from '@/components/load-more/index.vue'\r\n\tconst app = getApp()\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tbaseUrl: this.$baseURL,\r\n\t\t\t\tcarouselImages: [],\r\n\t\t\t\tcateList: [], // 所有类目\r\n\t\t\t\tnewPersonList: [],\r\n\t\t\t\tisShow:0,\r\n\t\t\t\tproductList: [],\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tpageSize: 5,\r\n\t\t\t\ttotalCount: 0,\r\n\t\t\t\tsearchWords: ''\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomponents: {\r\n\t\t\tProductItem,\r\n\t\t\tShopCart,\r\n\t\t\tLoadMore\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tnoMoreData() {\r\n\t\t\t\treturn this.page * this.pageSize >= this.totalCount\r\n\t\t\t},\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\tthis.getCarouselImages();\r\n\t\t\tthis.getCates();\r\n\t\t\tthis.getNewPerson()\r\n\t\t\tthis.getProductList()\r\n\t\t\t// 强制刷新购物车数据\r\n\t\t\tthis.refreshShopCart()\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\ttoCatePage(id = null) {\r\n\t\t\t\twx.setStorageSync('cateId', id)\r\n\t\t\t\tuni.switchTab({ url: '/pages/ifica/ifica' })\r\n\t\t\t},\r\n\t\t\ttoSearchPage() {\r\n\t\t\t\tuni.navigateTo({ url: `/pages/search-page/index?keywords=${this.searchWords}` })\r\n\t\t\t},\r\n\t\t\tloadMoreData() {\r\n\t\t\t\t// 加载完了\r\n\t\t\t\tif (this.noMoreData) return\r\n\t\t\t\tthis.page = this.page + 1\r\n\t\t\t\tthis.getProductList()\r\n\t\t\t},\r\n\t\t\tasync getProductList() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst { rows, total } = await this.$http.post('/items/recommend', {\r\n\t\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.productList = this.productList.concat(rows)\r\n\t\t\t\t\tthis.totalCount = total\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tthis.productList = []\r\n\t\t\t\t\tthis.totalCount = 0\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync getCarouselImages() {\r\n\t\t\t\ttry {\r\n\t\t\t\tconsole.log(11111)\r\n\t\t\t\t\tthis.carouselImages = await this.$http.post('/index/carousel', {})\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tthis.carouselImages = []\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync getCates() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis.cateList = await this.$http.post('/index/cats', {})\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tthis.cateList = []\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync getNewPerson() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst { rows } = await this.$http.post('/items/newperson', {\r\n\t\t\t\t\t\tpage: 1,\r\n\t\t\t\t\t\tpageSize: 10\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.newPersonList = rows.slice(0, 3)\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tthis.newPersonList = []\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 强制刷新购物车数据\r\n\t\t\trefreshShopCart() {\r\n\t\t\t\t// 使用全局事件触发购物车刷新\r\n\t\t\t\tuni.$emit('refreshShopCart')\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t@import url(/pages/index/index.css);\r\n\t@import url(/pages/index/prolast.css);\r\n</style>\r\n","import MiniProgramPage from '/Users/jiangzupei1/Desktop/melon-shop/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["wx","uni"],"mappings":";;AA0EC,MAAO,cAAa,MAAW;AAC/B,MAAK,WAAY,MAAW;AAC5B,iBAAiB,MAAW;AAChB,OAAO;AACnB,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,SAAS,KAAK;AAAA,MACd,gBAAgB,CAAE;AAAA,MAClB,UAAU,CAAE;AAAA;AAAA,MACZ,eAAe,CAAE;AAAA,MACjB,QAAO;AAAA,MACP,aAAa,CAAE;AAAA,MACf,MAAM;AAAA,MACN,UAAU;AAAA,MACV,YAAY;AAAA,MACZ,aAAa;AAAA,IACd;AAAA,EACA;AAAA,EACD,YAAY;AAAA,IACX;AAAA,IACA;AAAA,IACA;AAAA,EACA;AAAA,EACD,UAAU;AAAA,IACT,aAAa;AACZ,aAAO,KAAK,OAAO,KAAK,YAAY,KAAK;AAAA,IACzC;AAAA,EACD;AAAA,EACD,SAAS;AACR,SAAK,kBAAiB;AACtB,SAAK,SAAQ;AACb,SAAK,aAAa;AAClB,SAAK,eAAe;AAEpB,SAAK,gBAAgB;AAAA,EACrB;AAAA,EACD,SAAS;AAAA,IACR,WAAW,KAAK,MAAM;AACrBA,yBAAG,eAAe,UAAU,EAAE;AAC9BC,oBAAAA,MAAI,UAAU,EAAE,KAAK,sBAAsB;AAAA,IAC3C;AAAA,IACD,eAAe;AACdA,0BAAI,WAAW,EAAE,KAAK,qCAAqC,KAAK,WAAW,IAAI;AAAA,IAC/E;AAAA,IACD,eAAe;AAEd,UAAI,KAAK;AAAY;AACrB,WAAK,OAAO,KAAK,OAAO;AACxB,WAAK,eAAe;AAAA,IACpB;AAAA,IACD,MAAM,iBAAiB;AACtB,UAAI;AACH,cAAM,EAAE,MAAM,MAAM,IAAI,MAAM,KAAK,MAAM,KAAK,oBAAoB;AAAA,UACjE,MAAM,KAAK;AAAA,UACX,UAAU,KAAK;AAAA,SACf;AACD,aAAK,cAAc,KAAK,YAAY,OAAO,IAAI;AAC/C,aAAK,aAAa;AAAA,MACjB,SAAO,OAAO;AACf,aAAK,cAAc,CAAC;AACpB,aAAK,aAAa;AAAA,MACnB;AAAA,IACA;AAAA,IACD,MAAM,oBAAoB;AACzB,UAAI;AACJA,sBAAAA,MAAY,MAAA,OAAA,gCAAA,KAAK;AAChB,aAAK,iBAAiB,MAAM,KAAK,MAAM,KAAK,mBAAmB,EAAE;AAAA,MAChE,SAAO,OAAO;AACf,aAAK,iBAAiB,CAAC;AAAA,MACxB;AAAA,IACA;AAAA,IACD,MAAM,WAAW;AAChB,UAAI;AACH,aAAK,WAAW,MAAM,KAAK,MAAM,KAAK,eAAe,EAAE;AAAA,MACtD,SAAO,OAAO;AACf,aAAK,WAAW,CAAC;AAAA,MAClB;AAAA,IACA;AAAA,IACD,MAAM,eAAe;AACpB,UAAI;AACH,cAAM,EAAE,KAAG,IAAM,MAAM,KAAK,MAAM,KAAK,oBAAoB;AAAA,UAC1D,MAAM;AAAA,UACN,UAAU;AAAA,SACV;AACD,aAAK,gBAAgB,KAAK,MAAM,GAAG,CAAC;AAAA,MACnC,SAAO,OAAO;AACf,aAAK,gBAAgB,CAAC;AAAA,MACvB;AAAA,IACA;AAAA;AAAA,IAED,kBAAkB;AAEjBA,oBAAG,MAAC,MAAM,iBAAiB;AAAA,IAC5B;AAAA,EACA;AAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1KD,GAAG,WAAW,eAAe;"}